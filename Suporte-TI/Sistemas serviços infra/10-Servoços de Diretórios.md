# O que é um servidor de diretório

O servidor de diretórios contém um serviço de pesquisa que apresenta um mapeamento entre recursos de rede e os endereços de rede. Ele é usado para organizar e pesquisar objetos e entidades da empresa, que vão desde contas de usuários, grupos de usuários e números de telefone a compartilhamentos de rede. Em vez de gerenciar as contas de usuários e as informações do computador em cada máquina, todas essas informações podem ser armazenadas em um servidor de diretório para fácil acesso e gerenciamento.

O servidor de diretórios corporativo ideal deve oferecer suporte à replicação. Isso significa que os dados de diretório guardados podem ser copiados e distribuídos para vários servidores físicos, mas ainda assim aparecerem como um armazenamento unificado de dados para consulta e administração. Por que a replicação é importante? Ele oferece redundância ao disponibilizar vários servidores simultaneamente. Assim, haverá interrupção mínima do serviço caso um dos servidores tenha problemas. A replicação também diminui a latência quando você acessa o serviço de diretório. Com réplicas do seu servidor de diretório em cada escritório, é possível responder às consultas do serviço de diretório mais rapidamente.

O serviço de diretório também deve ser flexível e permitir que você crie facilmente novos tipos de objetos à medida que suas necessidades forem mudando. O acesso às informações armazenadas no banco de dados do servidor de diretório deve ficar disponível para vários tipos de sistemas operacionais e para as áreas designadas da rede corporativa. Os serviços de diretório são úteis para os organizar dados e torná-los pesquisáveis para uma organização. Consegue-se isso usando um modelo hierárquico de objetos e recipientes.

Os recipientes são chamados de unidades organizacionais, ou UOs, e podem conter objetos ou outras unidades organizacionais. Parece com a estrutura organizacional de um sistema de arquivos. As UOs são como pastas que podem conter arquivos individuais ou objetos de um serviço de diretório. As UOs também podem conter outras pastas.

Essa estrutura hierárquica pode ser usada para transmitir informações adicionais sobre o que está sendo armazenado. Pegue como exemplo sua estrutura de diretórios. Você pode ter uma UO chamada "Usuários" que contenha todas as contas de usuário. Dentro dessa UO, pode haver UOs adicionais que representam a estrutura da equipe da sua organização. A UO "Usuários" pode conter unidades organizacionais adicionais, como "Vendas", "Engenharia", "Marketing ", com os objetos "contas de usuário" para as pessoas que pertencem a essas equipes.

Essa estrutura pode ser usada para marcar as diferenças entre esses usuários da sub-UO. Por exemplo, poderíamos definir requisitos de senha mais rigorosos para membros da engenharia sem afetar as vendas ou o marketing. Os submembros herdam as características da UO pai. Assim, as alterações feitas na UO de nível mais alto afetariam todas as subunidades, incluindo vendas, marketing e engenharia. Alguém com as responsabilidades de administrador de sistemas, seja o administrador do sistema, seja o especialista em suporte de TI, seria responsável pela instalação, configuração e manutenção do servidor de diretório. O OS no qual o serviço de diretório é executado também.

Há tarefas comuns de gerenciamento de OS, como instalação das atualizações e configuração dos serviços padrão. Outras responsabilidades são a instalação e a configuração do próprio serviço de diretório, ou seja, instalar o serviço e configurar quaisquer serviços relacionados. Se forem usados vários servidores na configuração de replicação, eles também precisam ser configurados. É muito provável que a hierarquia da estrutura geral do diretório também seja de responsabilidade do administrador de sistemas quanto ao projeto e implementação.

## Implementando serviços de diretórios

Os serviços de diretório se tornaram um padrão de rede aberta para interoperabilidade entre diferentes fornecedores de software. Em 1988, o padrão de diretório X.500 foi aprovado e incluiu protocolos como o protocolo de acesso ao diretório, ou DAP; o protocolo de sistemas de diretórios, ou DSP; o protocolo de sombreamento de informações de diretório, ou DISP; e o protocolo de gerenciamento de ligações operacionais de diretórios, ou DOP.

As alternativas ao DAP foram projetadas para permitir que os clientes acessem o diretório X.500. A mais popular dessas alternativas foi o protocolo de acesso leve a diretórios, ou LDAP. Como esses são padrões abertos para comunicação e acesso a serviços de diretório, surgiram várias implementações diferentes desses serviços. Existem ofertas da Apache, Oracle, IBM.

A primeira é a implementação da Microsoft, que é chamada de **Active Directory, ou AD.** Ela tem opções de personalização e recursos adicionais para a plataforma Windows. Há também implementações gratuitas de serviços de diretório que usam o LDAP. Um exemplo comum é o OpenLDAP, que também abordaremos com mais detalhes. O OpenLDAP suporta uma ampla gama de plataformas como o Windows, Unix, Linux e várias outras distribuições. Além do software para servidores, também há ferramentas de cliente usadas para acessar e administrar um servidor de diretório, o Microsoft Office Active Directory Users and Computers, or ADUC, que funciona bem com o servidor da Microsoft Active Directory.

Existem também outras ferramentas gratuitas que podem ser usadas para fazer interface com outras implementações de servidor de diretório. Juntamente com clientes para administração e gerenciamento de servidor de diretório, há aplicativos de cliente que podem interagir e fazer consultas no servidor de diretório. Todas as principais plataformas de OS são suporte à integração com um servidor de diretório para fins de login e autenticação. A vantagem é o gerenciamento centralizado de contas de usuário. Ao buscar implementações específicas para seu servidor de diretório, considere o suporte do sistema operacional, não apenas o servidor que rodará o serviço de diretório em si, mas também o sistema operacional usado por sua frota e a compatibilidade ou suporte para seus serviços de diretório.

## Gerenciamento centralizado

Os administradores são responsáveis por diversos sistemas. E eles têm que gerenciar esses sistemas para que fiquem disponíveis para atender às suas funções na empresa. Por exemplo, como administrador de sistemas, posso ser responsável por garantir que todos os servidores da minha rede estejam atualizados com patches de segurança atualizações dos aplicativos.

O gerenciamento centralizado, um serviço central que dá instruções para todas as partes diferentes da minha infraestrutura de TI. Os serviços de diretório é um desses serviços. Imagine que você trabalhe para uma organização com dezenas, centenas ou até milhares de computadores e seus usuários. Não dá para entrar em cada um desses computadores para configurá-los. Os serviços de diretório oferecem autenticação, autorização e responsabilização (ou AAA) centralizadas.

Quando os computadores e os aplicativos são configurados para usarem serviços de diretório ou serviços AAA, passam a ser centralizadas as decisões de negação de acesso a computadores, sistemas de arquivos e outros recursos de TI. Assim você pode criar uma conta de usuário uma vez e ela ficar disponível para toda a rede imediatamente.
 Nas próximas aulas, vamos mergulhar mais fundo em dois dos serviços de diretório mais populares com LDAP: Active Directory e OpenLDAP.
Digamos que você tenha um sistema de arquivos de rede cujo acesso deve ser dado a todos do departamento de TI. Você poderia configurar o compartilhamento de rede, e, em seguida, usar uma uma lista de contas de usuário para conceder acesso ao compartilhamento. Mas o que acontecerá quando houver um novato no departamento de TI? E quando alguém for desligado? Em vez de conceder acesso com base na identidade da pessoa, que tal conceder acesso com base no que a pessoa faz? Na maioria das organizações, o acesso ao computador e aos recursos de rede baseia-se na função da pessoa na empresa. Quando você gerencia o acesso aos recursos de um computador e à rede, é frequente conceder e negar acesso com base em grupos de usuários. Os grupos de usuários podem ser usados para organizar contas de usuários de todas as formas. Você pode criar grupos de edifícios onde as pessoas trabalham ou de funções dentro da organização; ou qualquer agrupamento que você quiser.

**O importante é usar grupos para organizar as contas com base em sua forma de gerenciá-las.** Se você é administrador de sistemas, você pode ter permissão para fazer coisas como criar contas de usuário e redefinir senhas. Você está autorizado a fazer isso por causa de sua função de administrador de sistemas. Se você adicionar outro administrador de sistemas em sua organização, você não precisará descobrir todas as coisas às quais um administrador de sistema deve ter acesso nem conceder acesso individual a cada um desses recursos. Isso levaria uma eternidade. Em vez disso, vamos criar um grupo de administradores de sistemas e adicionar todos os administradores nesse grupo. Depois, podemos dar ao grupo de administradores de sistemas acesso a todos os recursos necessários. Se a função sua ou de outra pessoa mudar na empresa, tudo que você tem a fazer é mudar o grupo do qual você faz parte, não os direitos que você tem para acessar diretamente recursos. Chamamos esse controle de "acesso baseado na função", ou RBAC.

O controle de acesso aos recursos não é tudo que você pode fazer. Você também pode centralizar o gerenciamento de configurações. Da mesma forma que você não quer ir a cada computador para configurar as contas de usuário, não seria legal fazer o mesmo para configurar impressoras, ajustar softwares ou montar sistemas de arquivos de rede.

Ao centralizar o gerenciamento de configurações de seus computadores e softwares, você pode criar regras sobre como as coisas devem funcionar em sua organização. Uma maneira fácil de começar é usar uma ferramenta simples como os scripts de logon, que rodam toda vez que alguém faz logon em um computador. Mais adiante neste módulo, falaremos do Active Directory e de seus objetos para políticas de grupo, que são uma maneira de gerenciar as configurações de máquinas Windows. Há também as estruturas dedicadas de gerenciamento de configurações,, como o Chef, Puppet ou SCCM, que podem ser usadas para um gerenciamento simples ou mais poderoso das configurações. Elas estão fora do programa deste módulo, então confira a leitura suplementar após este vídeo para mais informações.

## LDAP

**"LDAP", ou protocolo de acesso leve ao diretório.** O LDAP é usado para acessar informações nos serviços de diretório, como em uma rede. Dois dos serviços de diretório mais comuns que usam o LDAP são o Active Directory e o openLDAP. Existem várias operações diferentes que você pode fazer no LDAP. Você pode adicionar uma nova entrada no banco de dados do servidor de diretório, como criar um novo objeto de usuário chamado "pedr0prs". Você pode excluir uma entrada no banco de dados do servidor de diretório. Você pode modificar entradas e muito, muito mais.

Quando dizemos "entrada", estamos nos referindo ao formato de entrada do LDAP ou à notação LDAP para registros no serviço de diretório. Uma entrada LDAP é simplesmente um conjunto de informações usadas para descrever algo.
O formato da entrada LDAP é basicamente:

`dn:CN=pedr0prs,OU=Sysadmin,DC=example,DC=com`

um nome de entrada exclusivo denotado por "dn", ou nome único, e depois os atributos e valores associados a ela. Então, CN é o "nome comum" do objeto. Neste caso, já que é uma pessoa, usamos pedr0prs como nome. UO é a unidade organizacional, como um grupo. E neste caso, usamos "Sysadmin". DC é o "componente principal". Então `example.com` é dividido em "example" e depois em "com". Novamente, não é necessário se lembrar desses atributos.

### O que é a autenticação LDAP

Ao usar o LDAP, existem diferentes níveis de autenticação que podem ser usados para restringir o acesso a certos diretórios, algo parecido com as listas telefônicas públicas ou com esses diretórios privados nos celulares. Talvez você tenha um diretório que queira tornar público para que qualquer pessoa possa ler as entradas ou talvez você só queira manter esses dados visíveis apenas para quem precisa.

Vamos discutir como o LDAP faz essa autenticação e quais métodos ele usa. Já virmos sobre as diferentes operações que você pode fazer com o LDAP, como adicionar, remover ou modificar entradas em um diretório. Outra operação que você pode executar é a operação de vinculação `binding`, que autentica clientes para o servidor de diretório. Digamos que você queira fazer login em um site que usa um serviço de diretório. Você insere os dados de login da conta e a senha; seus dados são enviados de volta para o site.

Ele usará o LDAP para verificar se a conta tem usuário e senha válidos no diretório. Se forem válidos, você terá acesso a essa conta. É bom que seus dados estejam protegidos e criptografados durante este processo. Existem três maneiras fazer autenticação.

**A primeira é anônima, a segunda é simples e a última é a SASL, ou camada simples de autenticação e segurança.**

Ao usar a vinculação anônima, você não está autenticando nada, dependendo da configuração, qualquer pessoa consegue acessar esse diretório, assim como no exemplo da lista telefônica pública.

Quando você usa a autenticação simples, você só precisa do nome da entrada no diretório e da senha, que geralmente são apenas letras, o que significa que não é nada segura.

Outro método de autenticação comumente usado é a autenticação SASL. Este método conta com a ajuda de protocolos de segurança como o TLS, que já aprendemos no Kerberos. A autenticação SASL exige que o servidor cliente e o servidor de diretório façam a autenticação usando algum método. Um dos métodos mais comuns dessa autenticação é usar o Kerberos.

O Kerberos é um protocolo de autenticação de rede usado para autenticar a identidade do usuário, proteger a transferência das credenciais de usuário e muito mais. Depois que o cliente faz a autenticação com o servidor LDAP ou o serviço de diretório, o usuário é autorizado a usar o nível de acesso que ele tiver.
