# Métodos de autorização e controle de acesso

Embora a autenticação esteja relacionada à verificação da identidade do usuário, a autorização diz respeito à descrição das coisas às quais a conta de usuário tem ou não tem acesso. São componentes separados e distintos do AAA e têm finalidades diferentes.

Um usuário pode se autenticar com sucesso em um sistema apresentando credenciais válidas, mas se o nome de usuário usado não estiver autorizado a acessar o referido sistema, o acesso será negado. Quando falamos sobre o Kerberos o usuário se autenticava e recebia um ticket de concessão de tickets. Ele pode ser usado para solicitar acesso a um serviço específico enviando um pedido para o serviço de concessão de tickets. É aí que a autorização entra em jogo, já que o serviço de concessão de tickets vai decidir se o usuário em questão pode ou não pode acessar o serviço solicitado. Se ele não puder acessar o serviço, o pedido será negado pelo serviço de concessão de tickets. Se o usuário estiver autorizado, o serviço de concessão de tickets devolve o ticket com autorização para o usuário acessar o serviço. Um padrão aberto muito comum para a autorização e delegação de acesso é o OAuth, que é usado por empresas como a Google, o Facebook e a Microsoft.

## Controle de acesso

O OAuth é um padrão aberto que permite que os usuários concedam a sites e aplicativos de terceiros acesso às suas informações sem compartilhar as credenciais de sua conta. Pode-se dizer que é uma forma de delegação de acesso, pois o acesso à conta do usuário está sendo delegado ao terceiro.

Isso é feito solicitando que o usuário confirme se ele concorda com a permissão para que terceiros acessem determinadas informações de sua conta. Normalmente, essa pergunta lista especificamente quais informações ou acessos estão sendo solicitados. Após a confirmação, o provedor de identidade dá ao terceiro um token que lhe permite acesso às informações do usuário. Este token pode ser usado pelo terceiro para acessar dados ou serviços oferecidos pelo provedor de identidade diretamente em nome do usuário.

O OAuth é comumente usado para conceder acesso a aplicativos e APIs de terceiros oferecidos por grandes empresas da Internet, como a Google, a Microsoft e o Facebook. Digamos que você queira usar um site de criação de memes de outra empresa. Este site permite que você crie memes usando modelos e lhe dá a opção de salvar suas criações e enviá-las por e-mail aos seus amigos. Em vez de o site enviar os e-mails diretamente, que viriam de um endereço que seus amigos não conhecem, o site usa o OAuth para obter permissão para enviar os memes usando diretamente sua conta de e-mail. Ele faz isso mediante uma solicitação do OAuth para seu provedor de e-mail. Depois que você aprova essa solicitação, o provedor de e-mail emite um token de acesso para o site, que concede ao site acesso à sua conta de email. O token de acesso tem um escopo, que diz que ele só pode ser usado para acessar o e-mail, não outros serviços associados à conta. Assim, ele consegue acessar o e-mail, mas não seus arquivos armazenados na nuvem nem a agenda, por exemplo.

É importante que os usuários prestem atenção no tipo de acesso solicitado pelo terceiro e no que está sendo autorizado. As permissões no OAuth podem ser usadas em ataques de phishing para obter acesso a contas sem exigir as credenciais. São enviados e-mails de phishing para vítimas potenciais que se parecem com solicitações legítimas de autorização do OAuth, pedindo que o usuário conceda acesso a alguns aspectos de sua conta por meio do OAuth. Depois que o usuário concede o acesso, o invasor tem acesso à conta por meio do token de autorização OAuth. Foi assim que houve um ataque de worm baseado em OAuth no início de 2017. Houve uma onda de e-mails de phishing que pareciam ser de um amigo ou de um colega que queria compartilhar um DOC no Google. Quando o link de compartilhamento era acessado, pedia-se à vítima que fizesse login e autorizasse o acesso a documentos e contatos de e-mail por algum serviço de terceiros, que se identificava apenas como Google Apps, mas, na verdade, era um serviço maligno que enviava um e-mail aos contatos da sua conta para perpetuar o ataque.

É importante fazer a diferença entre o OAuth e o OpenID. O OAuth é um sistema de autorização, e o OpenID é um sistema de autenticação. Embora geralmente eles sejam usados juntos, o OpenID Connect é uma camada de autenticação incorporada ao OAuth 2.0 projetada para melhorar o OpenID e criar uma melhor integração com as autorizações do OAuth. Como o TACACS+ é um sistema AAA completo, ele também lida com a autorização juntamente com a autenticação. Isso é feito quando um usuário é autenticado, permitindo-se ou não o acesso à conta do usuário para executar determinados comandos ou acessar determinados dispositivos. Isso permite que você dê acesso de administrador a certos usuários e dê acesso menos acesso privilegiado a outros usuários, quando necessário.

Sistemas AAA mais sofisticados ou configuráveis podem até permitir um maior refinamento da autorização até o nível de comando. Assim, você tem mais flexibilidade na concessão do acesso a usuários ou grupos específicos em sua organização. O RADIUS também permite autorizar o acesso à rede.

### Lista de controle de acesso

A lista de controle de acesso, ou ACL, é uma forma de definir permissões ou autorizações para objetos. O caso mais comum lida com permissões ao sistema de arquivos. O sistema de arquivos pode ter uma ACL, que é uma tabela ou banco de dados com uma lista de entradas especificando direitos de acesso para indivíduos ou grupos a vários objetos do sistema de arquivos, como pastas, arquivos ou programas.

Essas permissões de acesso individuais por objeto são chamadas de entradas de controle de acesso e integram a ACL. As entradas individuais podem definir permissões para controlar se um usuário ou grupo pode ou não ler, gravar ou executar objetos. As ACLs também são usadas amplamente na segurança de rede, aplicando controles de acesso a switches, firewalls e roteadores. As ACLs de rede são usadas para restringir e controlar o acesso aos serviços do hoster em execução nos hosts da sua rede. As ACLs de rede podem ser definidas para tráfegos de entrada e saída. Elas também podem ser usadas para restringir o acesso externo aos sistemas e limitar o tráfego de saída para efetivar políticas ou impedir transferências de dados de saída não autorizadas.

## Registro

### Monitoramento de uso e acesso

Por último, mas não menos importante, o último A dos três A's da segurança são os registros (accounting). Trata-se de manter registros de quais recursos e serviços seus usuários acessam ou o que eles fizeram quando estavam usando seus sistemas. Um componente fundamental é a auditoria, que envolve a revisão desses registros para garantir que nada esteja fora do normal.

O sistema AAA da CISCO da suporte aos registros de comandos individuais executados, à conexão de e para os dispositivos de rede, aos comandos executados em modo privilegiado e aos serviços de rede e detalhes do sistema, como redefinições de configurações ou reinicializações. O RADIUS rastreia detalhes como a duração da sessão, a localização do client, a largura de banda ou outros recursos utilizados durante a sessão. Isso ocorre porque o RADIUS é um sistema AAA de acesso à rede. Por isso, ele rastreia detalhes do acesso e do uso da rede. Os registros do RADIUS começam com o envio por parte do servidor de acesso à rede de um pacote de solicitação de registros ao servidor de registros, que contém um registrador de eventos. Assim é iniciada a sessão de registros no servidor. O servidor envia uma resposta de registro indicando que a mensagem foi recebida. O NASS continua enviando mensagens de registro periódicas com estatísticas da sessão até que um pacote de interrupção de registros seja recebido. Os registros do RADIUS podem ser usados para fins de cobrança por parte dos provedores, pois eles registram a duração de uma sessão e a quantidade de dados enviados e recebidos pelo usuário. Esses dados também podem ser usados para efetivar cotas de dados ou de tempo, limitando a duração das sessões ou restringindo a quantidade de dados que podem ser enviados ou recebidos. Mas essas informações não são detalhadas e não contêm detalhes do que o usuário fez durante a sessão. Informações como sites visitados ou quais protocolos foram usados não são registradas.